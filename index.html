<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buchhaltungs-Abkürzungen (DE-AR)</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-dark: #2c3e50;
            --primary-light: #34495e;
            --accent: #3498db;
            --accent-hover: #2980b9;
            --white: #ffffff;
            --gray-light: #f4f6f7;
            --gray-border: #dfe6e9;
            --success: #27ae60;
            --error: #c0392b;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--gray-light);
            color: var(--primary-dark);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* تنسيق النصوص العربية */
        .ar-text, .td-ar, .option-btn, header p {
            font-family: 'Cairo', sans-serif;
        }

        /* Header */
        header {
            background-color: var(--primary-dark);
            color: var(--white);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        header h1 {
            margin-bottom: 0.5rem;
            font-size: 1.8rem;
        }

        header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Navigation */
        nav {
            background-color: var(--primary-light);
            display: flex;
            justify-content: center;
            padding: 0.5rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        nav button {
            background: none;
            border: none;
            color: var(--white);
            padding: 10px 20px;
            margin: 0 5px;
            cursor: pointer;
            font-size: 1rem;
            font-family: 'Cairo', sans-serif;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        nav button:hover {
            background-color: rgba(255,255,255,0.1);
        }

        nav button.active {
            background-color: var(--accent);
            font-weight: bold;
        }

        /* Main Content */
        main {
            flex: 1;
            max-width: 900px;
            width: 100%;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .view-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .view-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Wörterbuch (Dictionary) --- */
        .search-box {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--gray-border);
            border-radius: 8px;
            font-size: 1.1rem;
            font-family: 'Cairo', sans-serif; /* Supports mixed input */
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .table-wrapper {
            background: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            overflow: hidden;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-border);
        }

        th {
            background-color: var(--primary-dark);
            color: var(--white);
            font-weight: 600;
        }

        tr:hover {
            background-color: #ecf0f1;
        }

        .td-ar {
            text-align: right;
            direction: rtl;
            color: var(--primary-dark);
            font-size: 1.05rem;
        }

        .abbr-tag {
            background-color: var(--accent);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.9rem;
            display: inline-block;
        }

        /* --- Flashcards --- */
        .flashcard-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 450px;
        }

        .scene {
            width: 100%;
            max-width: 500px;
            height: 300px;
            perspective: 1000px;
            cursor: pointer;
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.8s;
            transform-style: preserve-3d;
            border-radius: 16px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        .card.is-flipped {
            transform: rotateY(180deg);
        }

        .card__face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .card__face--front {
            background-color: var(--white);
            border: 2px solid var(--accent);
        }

        .card__face--front h2 {
            font-size: 4rem;
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .card__face--front .hint {
            color: #95a5a6;
            font-family: 'Cairo', sans-serif;
            font-size: 0.9rem;
        }

        .card__face--back {
            background-color: var(--accent);
            color: white;
            transform: rotateY(180deg);
        }

        .card__face--back .term-de {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .card__face--back .term-ar {
            font-size: 1.6rem;
            font-family: 'Cairo', sans-serif;
            direction: rtl;
            line-height: 1.4;
        }

        .controls {
            margin-top: 2rem;
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 12px 24px;
            background-color: var(--primary-dark);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-family: 'Cairo', sans-serif;
            transition: background 0.2s;
        }

        .btn:hover {
            background-color: var(--primary-light);
        }

        /* --- Quiz --- */
        .quiz-wrapper {
            background: var(--white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .score-board {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-border);
            font-family: 'Cairo', sans-serif;
            font-weight: bold;
        }

        .question h2 {
            font-size: 3rem;
            color: var(--accent);
            margin: 1rem 0 2rem 0;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        @media (min-width: 600px) {
            .options-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .option-btn {
            background-color: var(--gray-light);
            border: 2px solid var(--gray-border);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.2s;
            direction: rtl;
        }

        .option-btn:hover:not([disabled]) {
            border-color: var(--accent);
            background-color: #eaf2f8;
        }

        .option-btn.correct {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }

        .option-btn.wrong {
            background-color: var(--error);
            color: white;
            border-color: var(--error);
        }

        .feedback-msg {
            margin-top: 1.5rem;
            min-height: 25px;
            font-weight: bold;
            font-family: 'Cairo', sans-serif;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 2rem;
            background-color: var(--primary-dark);
            color: #95a5a6;
            margin-top: auto;
            font-family: 'Cairo', sans-serif;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>

<header>
    <h1>Buchhaltungs-Abkürzungen</h1>
    <p>تعلم مصطلحات المحاسبة الألمانية (Deutsch - Arabisch)</p>
</header>

<nav>
    <button class="nav-btn active" onclick="switchTab('dictionary')">القاموس / Wörterbuch</button>
    <button class="nav-btn" onclick="switchTab('flashcards')">البطاقات / Karteikarten</button>
    <button class="nav-btn" onclick="switchTab('quiz')">الاختبار / Quiz</button>
</nav>

<main>
    <section id="dictionary" class="view-section active">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="بحث (مثال: AfA, Umsatzsteuer, ضريبة)...">
        </div>
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th width="15%">Abk.</th>
                        <th width="40%">Deutsch</th>
                        <th width="45%" style="text-align: right;">Arabisch</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    </tbody>
            </table>
        </div>
    </section>

    <section id="flashcards" class="view-section">
        <div class="flashcard-area">
            <div class="scene">
                <div class="card" id="flashcard">
                    <div class="card__face card__face--front">
                        <h2 id="fc-abbr">AfA</h2>
                        <span class="hint">انقر لقلب البطاقة / Klicken zum Drehen</span>
                    </div>
                    <div class="card__face card__face--back">
                        <div class="term-de" id="fc-de">Absetzung für Abnutzung</div>
                        <div class="term-ar" id="fc-ar">الإهلاك</div>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn" onclick="prevCard()">السابق &#8594;</button>
                <button class="btn" onclick="nextCard()">&#8592; التالي</button>
            </div>
            <p style="margin-top: 15px; color: #7f8c8d;" id="fc-counter">1 / 50</p>
        </div>
    </section>

    <section id="quiz" class="view-section">
        <div class="quiz-wrapper">
            <div class="score-board">
                <span>النقاط: <span id="score">0</span></span>
                <span>سؤال رقم: <span id="q-num">1</span></span>
            </div>
            
            <div class="question">
                <p style="font-family: 'Cairo', sans-serif;">ما معنى هذا الاختصار؟</p>
                <h2 id="quiz-abbr">?</h2>
            </div>
            
            <div class="options-grid" id="quiz-options">
                </div>
            
            <div class="feedback-msg" id="quiz-feedback"></div>
            
            <button class="btn" id="next-quiz-btn" style="display: none; margin: 15px auto;" onclick="nextQuestion()">السؤال التالي</button>
        </div>
    </section>
</main>

<footer>
    تم تطوير هذا التطبيق التعليمي بناءً على المصطلحات المقدمة. <br>
    &copy; 2026 Accounting Learning Tool
</footer>

<script>
    /**
     * البيانات الكاملة حسب القائمة المقدمة
     */
    const data = [
        { abbr: "A", de: "Abschnitt", ar: "مقطع" },
        { abbr: "AB", de: "Anfangsbestand", ar: "رصيد أول المدة" },
        { abbr: "AfA", de: "Absetzung für Abnutzung", ar: "الإهلاك" },
        { abbr: "AG", de: "Aktiengesellschaft", ar: "شركة مساهمة" },
        { abbr: "AktG", de: "Aktiengesetz", ar: "قانون الشركات المساهمة" },
        { abbr: "AK", de: "Anschaffungskosten", ar: "تكاليف الحيازة/الشراء" },
        { abbr: "alul", de: "aus Lieferungen und Leistungen", ar: "من التوريدات والخدمات" },
        { abbr: "AN", de: "Arbeitnehmer", ar: "موظف" },
        { abbr: "ANK", de: "Anschaffungsnebenkosten", ar: "تكاليف الشراء الجانبية" },
        { abbr: "AO", de: "Abgabenordnung", ar: "قانون الضرائب الألماني" },
        { abbr: "AR", de: "Ausgangsrechnung", ar: "فاتورة صادرة" },
        { abbr: "AV", de: "Anlagevermögen/Arbeitslosenversicherung", ar: "الأصول الثابتة أو تأمين البطالة" },
        { abbr: "B", de: "Berichtigungsschlüssel", ar: "مفتاح التصحيح" },
        { abbr: "BA", de: "Bundesanzeiger/Betriebsausgaben", ar: "الجريدة الرسمية الاتحادية أو مصاريف تشغيلية" },
        { abbr: "BdF", de: "Bundesminister der Finanzen", ar: "وزير المالية الاتحادي" },
        { abbr: "BFH", de: "Bundesfinanzhof", ar: "محكمة المالية الاتحادية" },
        { abbr: "BGA", de: "Betriebs- und Geschäftsausstattung", ar: "التجهيزات التشغيلية والمكتبية" },
        { abbr: "BGB", de: "Bürgerliches Gesetzbuch", ar: "القانون المدني" },
        { abbr: "BilMoG", de: "Bilanzrechtsmodernisierungsgesetz", ar: "قانون تحديث قانون الميزانية العمومية" },
        { abbr: "BMF", de: "Bundesministerium der Finanzen", ar: "وزارة المالية الاتحادية" },
        { abbr: "BpO", de: "Betriebsprüfungsordnung", ar: "نظام التفتيش الضريبي" },
        { abbr: "BStBl", de: "Bundessteuerblatt", ar: "المجلة الضريبية الاتحادية" },
        { abbr: "BuG", de: "Betriebs- und Geschäftsausstattung", ar: "التجهيزات التشغيلية والمكتبية" },
        { abbr: "BV", de: "Betriebsvermögen", ar: "رأس مال المنشأة" },
        { abbr: "BWA", de: "Betriebswirtschaftliche Auswertung", ar: "التقييم الاقتصادي للأعمال" },
        { abbr: "DATEV", de: "Datenverarbeitungsorganisation des steuerberatenden Berufes", ar: "منظمة معالجة البيانات لمهنة الاستشارات الضريبية" },
        { abbr: "DB", de: "Der Betrieb", ar: "المجلة المهنية 'التشغيل'" },
        { abbr: "Eh.", de: "Einzelhandel", ar: "تجارة التجزئة" },
        { abbr: "e.K.", de: "eingetragener Kaufmann", ar: "تاجر مسجل" },
        { abbr: "EK", de: "Eigenkapital", ar: "حقوق الملكية" },
        { abbr: "ER", de: "Eingangsrechnung", ar: "فاتورة واردة" },
        { abbr: "ESt", de: "Einkommensteuer", ar: "ضريبة الدخل" },
        { abbr: "EStDV", de: "Einkommensteuer-Durchführungsverordnung", ar: "لائحة تنفيذ ضريبة الدخل" },
        { abbr: "ESTH", de: "Amtliches Einkommensteuer-Handbuch", ar: "دليل ضريبة الدخل الرسمي" },
        { abbr: "EStG", de: "Einkommensteuergesetz", ar: "قانون ضريبة الدخل" },
        { abbr: "ESTR", de: "Einkommensteuer-Richtlinien", ar: "المبادئ التوجيهية لضريبة الدخل" },
        { abbr: "EU", de: "Europäische Union", ar: "الاتحاد الأوروبي" },
        { abbr: "EUSt", de: "Einfuhrumsatzsteuer", ar: "ضريبة استيراد القيمة المضافة" },
        { abbr: "EV", de: "Eigenverbrauch", ar: "الاستهلاك الشخصي" },
        { abbr: "FA", de: "Finanzamt", ar: "مكتب الضرائب" },
        { abbr: "FK", de: "Fremdkapital", ar: "رأس المال المقترض/الديون" },
        { abbr: "GewSt", de: "Gewerbesteuer", ar: "ضريبة التجارة" },
        { abbr: "GKR", de: "Gemeinschaftskontenrahmen der Industrie", ar: "مخطط الحسابات المشترك للصناعة" },
        { abbr: "GmbH", de: "Gesellschaft mit beschränkter Haftung", ar: "شركة ذات مسؤولية محدودة" },
        { abbr: "GoB", de: "Grundsätze ordnungsgemäßer Buchführung", ar: "مبادئ المحاسبة السليمة" },
        { abbr: "GOBS", de: "Grundsätze ordnungsgemäßer DV-gestützter Buchführungssysteme", ar: "مبادئ أنظمة المحاسبة المحوسبة" },
        { abbr: "GoS", de: "Grundsätze ordnungsgemäßer Speicherbuchführung", ar: "مبادئ محاسبة التخزين" },
        { abbr: "GuVK", de: "Gewinn- und Verlustkonto", ar: "حساب الأرباح والخسائر" },
        { abbr: "GuVR", de: "Gewinn- und Verlustrechnung", ar: "قائمة الأرباح والخسائر" },
        { abbr: "GWG", de: "geringwertiges Wirtschaftsgut", ar: "أصول منخفضة القيمة" },
        { abbr: "H", de: "Hinweise/Haben", ar: "ملاحظات أو 'له/دائن'" },
        { abbr: "HAÜ", de: "Hauptabschlussübersicht", ar: "ملخص الإقفال الرئيسي" },
        { abbr: "HB", de: "Handelsbilanz", ar: "الميزانية العمومية التجارية" },
        { abbr: "HGB", de: "Handelsgesetzbuch", ar: "القانون التجاري" },
        { abbr: "HK", de: "Herstellungskosten", ar: "تكاليف التصنيع" },
        { abbr: "HR", de: "Handelsregister", ar: "السجل التجاري" },
        { abbr: "IDW", de: "Hauptausschuss des Instituts für Wirtschaftsprüfer", ar: "اللجنة الرئيسية لمعهد مدققي الحسابات" },
        { abbr: "IKR", de: "Industriekontenrahmen", ar: "مخطط الحسابات الصناعي" },
        { abbr: "INSO", de: "Insolvenzgeldumlage", ar: "رسوم إعانات الإعسار" },
        { abbr: "K", de: "Kontokorrent", ar: "الحساب الجاري" },
        { abbr: "KG", de: "Kommanditgesellschaft", ar: "شركة توصية بسيطة" },
        { abbr: "KiSt", de: "Kirchensteuer", ar: "ضريبة الكنيسة" },
        { abbr: "KSt", de: "Körperschaftsteuer", ar: "ضريبة الشركات" },
        { abbr: "KV", de: "Krankenversicherung", ar: "التأمين الصحي" },
        { abbr: "LFZG", de: "Lohnfortzahlungsgesetz", ar: "قانون استمرار دفع الأجور" },
        { abbr: "LSt", de: "Lohnsteuer", ar: "ضريبة الأجور" },
        { abbr: "LStDV", de: "Lohnsteuer-Durchführungsverordnung", ar: "لائحة تنفيذ ضريبة الأجور" },
        { abbr: "MwStSystR", de: "Mehrwertsteuer-Systemrichtlinie", ar: "التوجيه الموحد لنظام ضريبة القيمة المضافة" },
        { abbr: "m.Z.", de: "mit Zinsschein", ar: "مع قسيمة فوائد" },
        { abbr: "ND", de: "Nutzungsdauer", ar: "العمر الإنتاجي" },
        { abbr: "OFD", de: "Oberfinanzdirektion", ar: "مديرية المالية العليا" },
        { abbr: "OHG", de: "offene Handelsgesellschaft", ar: "شركة تضامن مفتوحة" },
        { abbr: "o.Z.", de: "ohne Zinsschein", ar: "بدون قسيمة فوائد" },
        { abbr: "PflegeVG", de: "Pflegeversicherungsgesetz", ar: "قانون تأمين الرعاية" },
        { abbr: "PV", de: "Pflegeversicherung", ar: "تأمين الرعاية" },
        { abbr: "PublG", de: "Publizitätsgesetz", ar: "قانون الإفصاح" },
        { abbr: "R", de: "Richtlinie", ar: "مبدأ توجيهي" },
        { abbr: "rkr.", de: "rechtskräftig", ar: "ملزم قانوناً" },
        { abbr: "RV", de: "Rentenversicherung", ar: "تأمين التقاعد" },
        { abbr: "Rz.", de: "Randziffer/Randzahl", ar: "رقم الهامش" },
        { abbr: "S", de: "Soll", ar: "منه/مدين" },
        { abbr: "SachbezV", de: "Sachbezugsverordnung", ar: "لائحة المزايا العينية" },
        { abbr: "SB", de: "Schlussbestand", ar: "رصيد الإقفال" },
        { abbr: "SBK", de: "Schlussbilanzkonto", ar: "حساب الميزانية العمومية الختامية" },
        { abbr: "SKR", de: "Spezialkontenrahmen", ar: "مخطط حسابات متخصص" },
        { abbr: "SL", de: "sonstige Leistung", ar: "خدمة أخرى" },
        { abbr: "SoIZ", de: "Solidaritätszuschlag", ar: "ضريبة التضامن الإضافية" },
        { abbr: "SoIZG", de: "Solidaritätszuschlagsgesetz", ar: "قانون ضريبة التضامن الإضافية" },
        { abbr: "StB", de: "Steuerbilanz", ar: "الميزانية العمومية الضريبية" },
        { abbr: "StBereinG", de: "Steuerbereinigungsgesetz", ar: "قانون التطهير الضريبي" },
        { abbr: "StEntlG", de: "Steuerentlastungsgesetz", ar: "قانون الإعفاء الضريبي" },
        { abbr: "StEuglG", de: "Steuer-Euroglättungsgesetz", ar: "قانون تعديل اليورو الضريبي" },
        { abbr: "SV", de: "Saldovortrag", ar: "ترحيل الرصيد" },
        { abbr: "SvEV", de: "Sozialversicherungsentgeltverordnung", ar: "لائحة أجور التأمينات الاجتماعية" },
        { abbr: "Tz.", de: "Textziffer/Textzahl", ar: "رقم النص" },
        { abbr: "U1", de: "Umlage 1", ar: "الرسوم 1" },
        { abbr: "U2", de: "Umlage 2", ar: "الرسوم 2" },
        { abbr: "USt", de: "Umsatzsteuer", ar: "ضريبة المبيعات/القيمة المضافة" },
        { abbr: "USTAE", de: "Umsatzsteuer-Anwendungserlass", ar: "مرسوم تطبيق ضريبة المبيعات" },
        { abbr: "USEDV", de: "Umsatzsteuer-Durchführungsverordnung", ar: "لائحة تنفيذ ضريبة المبيعات" },
        { abbr: "USt-IdNr.", de: "Umsatzsteuer-Identifikationsnummer", ar: "رقم تعريف ضريبة المبيعات" },
        { abbr: "UV", de: "Umlaufvermögen", ar: "الأصول المتداولة" },
        { abbr: "vBP", de: "vereidigter Buchprüfer", ar: "مدقق حسابات محلف" },
        { abbr: "VermBG", de: "Vermögensbildungsgesetz", ar: "قانون تكوين الأصول" },
        { abbr: "VoSt", de: "Vorsteuer", ar: "ضريبة المدخلات" },
        { abbr: "VSt", de: "Vermögensteuer", ar: "ضريبة الثروة" },
        { abbr: "vwL", de: "vermögenswirksame Leistungen", ar: "المزايا المكونة للأصول" },
        { abbr: "VZ", de: "Veranlagungszeitraum", ar: "فترة التقييم الضريبي" },
        { abbr: "WG", de: "Wechselgesetz", ar: "قانون الكمبيالات" },
        { abbr: "WoBauFG", de: "Wohnungsbauförderungsgesetz", ar: "قانون تشجيع بناء المساكن" },
        { abbr: "WOPG", de: "Wohnungsbau-Prämiengesetz", ar: "قانون علاوة بناء المساكن" },
        { abbr: "WP", de: "Wirtschaftsprüfer", ar: "مدقق حسابات" },
        { abbr: "WStG", de: "Wechselsteuergesetz", ar: "قانون ضريبة الكمبيالات" },
        { abbr: "ZM", de: "Zusammenfassende Meldung", ar: "تقرير ملخص" }
    ];

    // --- State Variables ---
    let currentTab = 'dictionary';
    let currentCardIndex = 0;
    let quizScore = 0;
    let quizQuestionCount = 1;
    let currentQuizItem = null;

    // --- Init ---
    document.addEventListener('DOMContentLoaded', () => {
        renderTable(data);
        renderFlashcard();
        generateQuizQuestion();
    });

    // --- Navigation Logic ---
    function switchTab(tabName) {
        // Toggle Sections
        document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
        document.getElementById(tabName).classList.add('active');
        
        // Toggle Buttons
        const btns = document.querySelectorAll('.nav-btn');
        btns.forEach(btn => btn.classList.remove('active'));
        if(tabName === 'dictionary') btns[0].classList.add('active');
        if(tabName === 'flashcards') btns[1].classList.add('active');
        if(tabName === 'quiz') btns[2].classList.add('active');
    }

    // --- Dictionary Logic ---
    const tableBody = document.getElementById('tableBody');
    const searchInput = document.getElementById('searchInput');

    function renderTable(items) {
        tableBody.innerHTML = '';
        if (items.length === 0) {
            tableBody.innerHTML = `<tr><td colspan="3" style="text-align:center; padding: 20px;">لا توجد نتائج / Keine Ergebnisse</td></tr>`;
            return;
        }
        items.forEach(item => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><span class="abbr-tag">${item.abbr}</span></td>
                <td>${item.de}</td>
                <td class="td-ar">${item.ar}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    searchInput.addEventListener('input', (e) => {
        const val = e.target.value.toLowerCase();
        const filtered = data.filter(item => 
            item.abbr.toLowerCase().includes(val) || 
            item.de.toLowerCase().includes(val) || 
            item.ar.includes(val)
        );
        renderTable(filtered);
    });

    // --- Flashcards Logic ---
    const flashcard = document.getElementById('flashcard');
    const fcAbbr = document.getElementById('fc-abbr');
    const fcDe = document.getElementById('fc-de');
    const fcAr = document.getElementById('fc-ar');
    const fcCounter = document.getElementById('fc-counter');

    flashcard.addEventListener('click', () => {
        flashcard.classList.toggle('is-flipped');
    });

    function renderFlashcard() {
        flashcard.classList.remove('is-flipped');
        
        setTimeout(() => {
            const item = data[currentCardIndex];
            fcAbbr.textContent = item.abbr;
            fcDe.textContent = item.de;
            fcAr.textContent = item.ar;
            fcCounter.textContent = `${currentCardIndex + 1} / ${data.length}`;
        }, 200);
    }

    window.nextCard = function() {
        currentCardIndex = (currentCardIndex + 1) % data.length;
        renderFlashcard();
    }

    window.prevCard = function() {
        currentCardIndex = (currentCardIndex - 1 + data.length) % data.length;
        renderFlashcard();
    }

    // --- Quiz Logic ---
    const quizAbbr = document.getElementById('quiz-abbr');
    const quizOptions = document.getElementById('quiz-options');
    const quizFeedback = document.getElementById('quiz-feedback');
    const scoreEl = document.getElementById('score');
    const qNumEl = document.getElementById('q-num');
    const nextBtn = document.getElementById('next-quiz-btn');

    window.generateQuizQuestion = function() {
        quizFeedback.textContent = '';
        nextBtn.style.display = 'none';
        
        // Random Question
        const randIndex = Math.floor(Math.random() * data.length);
        currentQuizItem = data[randIndex];
        
        quizAbbr.textContent = currentQuizItem.abbr;
        
        // Generate Distractors
        let options = [currentQuizItem];
        while (options.length < 4) {
            const distractor = data[Math.floor(Math.random() * data.length)];
            // Ensure uniqueness
            if (!options.some(o => o.abbr === distractor.abbr)) {
                options.push(distractor);
            }
        }
        
        // Shuffle
        options.sort(() => Math.random() - 0.5);
        
        // Render
        quizOptions.innerHTML = '';
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.textContent = opt.ar;
            btn.onclick = () => checkAnswer(opt, btn);
            quizOptions.appendChild(btn);
        });
    }

    function checkAnswer(selected, btn) {
        // Disable buttons
        const allBtns = document.querySelectorAll('.option-btn');
        allBtns.forEach(b => b.disabled = true);
        
        if (selected.abbr === currentQuizItem.abbr) {
            // Correct
            btn.classList.add('correct');
            quizFeedback.textContent = 'إجابة صحيحة! ممتاز';
            quizFeedback.style.color = 'var(--success)';
            quizScore++;
            scoreEl.textContent = quizScore;
        } else {
            // Wrong
            btn.classList.add('wrong');
            quizFeedback.textContent = `خطأ. الإجابة الصحيحة هي: ${currentQuizItem.ar}`;
            quizFeedback.style.color = 'var(--error)';
            
            // Highlight Correct
            allBtns.forEach(b => {
                if (b.textContent === currentQuizItem.ar) b.classList.add('correct');
            });
        }
        nextBtn.style.display = 'block';
    }

    window.nextQuestion = function() {
        quizQuestionCount++;
        qNumEl.textContent = quizQuestionCount;
        generateQuizQuestion();
    }

</script>

</body>
</html>
